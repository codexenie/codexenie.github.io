<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>DOUBLE_FREE · codeXenie Rule Page</title><meta name="description" content="DOUBLE_FREE - CodeScroll"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="https://avatars1.githubusercontent.com/u/29533708?v=3&amp;s=460"><link rel="stylesheet" href="/css/gandalfr.css"><link rel="stylesheet" href="https://highlightjs.org/static/demo/styles/solarized-light.css"><link rel="search" type="application/opensearchdescription+xml" href="https://github.com/codexenie/atom.xml" title="codeXenie Rule Page"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="http://cfile203.uf.daum.net/image/23489C4B5768FA031D7EBA" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">HOME</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><div class="post-content"><h2 id="Double-Free-Prohibit-deallocating-memory-duplication"><a href="#Double-Free-Prohibit-deallocating-memory-duplication" class="headerlink" title="Double_Free Prohibit deallocating memory duplication"></a>Double_Free Prohibit deallocating memory duplication</h2><hr>
<p>If the deallocated pointer variable is deallocated again, the unexpected memory location can be changed. </p>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>If the same pointer variable is deallocated twice, the data structure for controlling the memory can be damaged. Due to this damage, the program can be ended or two times memory allocation can return the same pointer. If the memory allocation returns the same value twice and the attacker can control this memory area, he can attack by buffer overflow. </p>
<h4 id="example-1"><a href="#example-1" class="headerlink" title="example 1"></a><strong>example 1</strong></h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">char</span>* ptr = (<span class="keyword">char</span>*)<span class="built_in">malloc</span> (SIZE);</div><div class="line">...</div><div class="line"><span class="keyword">if</span> (abrt) &#123;</div><div class="line">    <span class="built_in">free</span>(ptr);</div><div class="line">&#125;</div><div class="line">    ...</div><div class="line"><span class="built_in">free</span>(ptr);</div></pre></td></tr></table></figure>
<p>Generally, the memory duplication deallocation is occurred by the following two reasons.</p>
<ul>
<li>Error condition or exception situation</li>
<li>Confused situation which part of program is responsible for memory deallocation.</li>
</ul>
<p>Several duplication deallocation weaknesses are not more complicated than the example, but in certain case, they can be occurred apart from more than hundreds lines or in the other file. A programmer frequently deallocates the global variable in particular twice.</p>
<h3 id="Related-Link"><a href="#Related-Link" class="headerlink" title="Related Link"></a>Related Link</h3><ul>
<li><a href="http://cwe.mitre.org/data/definitions/415.html" target="_blank" rel="external">CWE 415: Double Free</a></li>
</ul>
<hr>
</div></article></div></main><footer><div class="paginator"><a href="/FREE_STACK/" class="next">NEXT</a></div><div class="copyright"><p>© 2017 <a href="https://github.com/codexenie">CodeScroll</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/MikeCoder/hexo-theme-gandalfr" target="_blank">hexo-theme-gandalfr</a>.</p></div></footer></div><script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" crossorigin="anonymous"></script><script src="//cdn.bootcss.com/jquery/3.1.1/jquery.js" crossorigin="anonymous"></script><script>$(document).ready(function() { $('pre').each(function(i, block) { hljs.highlightBlock(block); }); });</script></body></html>